<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Library Home</title>
  </head>
  <body>
    <h1>My Library</h1>

    <form action="/" method="GET">
      <input type="text" name="search" placeholder="Search for a book title..." value="{{ search_query if search_query else '' }}">
      <input type="submit" value="Search">
      {% if search_query %}
        <a href="/">Clear Search</a>
      {% endif %}
    </form>

    <div style="margin-top: 10px;">
      <span>Sort by: </span>
      <a href="/?sort_by=title{% if search_query %}&search={{ search_query }}{% endif %}">Title</a> |
      <a href="/?sort_by=author{% if search_query %}&search={{ search_query }}{% endif %}">Author</a>
    </div>
    <hr>

    {% if books %}
      {% for book in books %}
      <div>
        <img src="https://covers.openlibrary.org/b/isbn/{{ book.isbn }}-M.jpg" alt="Cover" style="width:100px;">
        <h3>{{ book.title }}</h3>
        <p>Author: {{ book.author.name }}</p>
      </div>
      <hr>
      {% endfor %}
    {% else %}
      <p>No books found matching your criteria.</p>
    {% endif %}

  </body>
</html>